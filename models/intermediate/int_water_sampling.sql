SELECT
    doc_id::text AS id,
    parent_ident::text AS parent_id,
    date_of_sample_collection || ' (' || date_of_sample_collection || ')' AS contact_tree_label,
    mform_id::text AS mform_id,
    mform_event::text AS mform_event,
    event_ident::text AS event_id,
    form_id::text AS form_id,
    case_unique_id::text AS case_unique_id,
    (CASE WHEN df_complete::text = 'true' THEN 'Complete' ELSE 'Draft' END)::text AS completed,
    (CASE WHEN df_parent_complete::text = 'true' THEN 'Complete' ELSE 'Draft' END)::text AS parent_completed,
    created_role::text AS created_role,
    modified_role::text AS modified_role,
    created_username::text AS created_username,
    created_timestamp::text AS created_timestamp,
    modified_username::text AS modified_username,
    modified_timestamp::text AS modified_timestamp,
    location_accuracy::text AS location_accuracy,
    location_latitude::text AS location_latitude,
    location_longitude::text AS location_longitude,
    CASE WHEN date_of_sample_collection ~ '^\d{2}/\d{2}/\d{4}$' THEN to_timestamp(date_of_sample_collection, 'DD/MM/YYYY')::date ELSE NULL END AS case_date,
    CASE WHEN date_of_sample_collection ~ '^\d{2}/\d{2}/\d{4}$' THEN to_char(to_timestamp(date_of_sample_collection, 'DD/MM/YYYY'), 'YYYY "W"IW') ELSE NULL END AS epi_week,
    ''::text AS syndrome,
    'Water Sampling'::text AS disease,
    sample_number::text AS sample_number,
    date_of_sample_collection::text AS date_of_sample_collection,
    time_of_sample_collection::text AS time_of_sample_collection,
    reason_for_sampling::text AS reason_for_sampling,
    reason_for_sampling_other::text AS reason_for_sampling_other,
    source_of_sample::text AS source_of_sample,
    sample_supected_of_causing_illness::text AS sample_supected_of_causing_illness,
    sample_source_has_pump::text AS sample_source_has_pump,
    sample_source_pump_usage_duration::text AS sample_source_pump_usage_duration,
    sample_source_pump_overhaul::text AS sample_source_pump_overhaul,
    sample_is_repeat::text AS sample_is_repeat,
    previous_sample_status::text AS previous_sample_status,
    rejected_sample_tracking_number::text AS rejected_sample_tracking_number,
    sources_of_pollution_exist::text AS sources_of_pollution_exist,
    type_of_pollution::text AS type_of_pollution,
    description_of_pollution::text AS description_of_pollution,
    water_sample_source_is_treated::text AS water_sample_source_is_treated,
    water_sample_source_method_of_treatment::text AS water_sample_source_method_of_treatment,
    water_sample_source_date_of_treatment::text AS water_sample_source_date_of_treatment,
    sample_collector_name::text AS sample_collector_name,
    sample_collector_designation::text AS sample_collector_designation,
    collector_phone_number::text AS collector_phone_number,
    collectors_email_address::text AS collectors_email_address,
    date_of_sample_reception::text AS date_of_sample_reception,
    date_of_sample_examination::text AS date_of_sample_examination,
    presumptive_coli_test::text AS presumptive_coli_test,
    escherichia_coli::text AS escherichia_coli,
    specialist_bacteriologist::text AS specialist_bacteriologist,
    compiled_by::text AS compiled_by,
    reviewed_by::text AS reviewed_by,
    title_site_information::text AS title_site_information,
    county::text AS county,
    subcounty::text AS subcounty,
    ward::text AS ward,
    landmark::text AS landmark,
    sample_collection_pickup_site::text AS sample_collection_pickup_site
FROM {{ ref('stg_water_sampling') }}
