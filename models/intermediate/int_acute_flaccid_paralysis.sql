SELECT
    mform_id::text AS mform_id,
    form_id::text AS form_id,
    case_unique_id::text AS case_unique_id,
    created_username::text AS created_username,
    created_timestamp::text AS created_timestamp,
    modified_username::text AS modified_username,
    modified_timestamp::text AS modified_timestamp,
    location_accuracy::text AS location_accuracy,
    location_latitude::text AS location_latitude,
    location_longitude::text AS location_longitude,
    syndrome::text AS syndrome,
    disease::text AS disease,
    epid::text AS epid,
    date_of_investigation::text AS date_of_investigation,
    given_name::text AS given_name,
    family_name::text AS family_name,
    sex::text AS sex,
    age_years::float AS age_years,
    age_months::float AS age_months,
    CASE
        WHEN age_years::float < 2 THEN '0-2 yrs'
        WHEN age_years::float BETWEEN 2 AND 5 THEN '2-5 yrs'
        WHEN age_years::float BETWEEN 5 AND 16 THEN '5-16 yrs'
        WHEN age_years::float > 16 THEN '16+ yrs'
        ELSE 'Unknown'
    END AS age_group,
    date_of_birth::text AS date_of_birth,
    country::text AS country,
    county::text AS county,
    subcounty::text AS subcounty,
    phone_number::text AS phone_number,
    occupation::text AS occupation,
    occupation_other::text AS occupation_other,
    title_residence::text AS title_residence,
    town_village_camp::text AS town_village_camp,
    landmark::text AS landmark,
    title_parent_guradian::text AS title_parent_guradian,
    guardian_family_name::text AS guardian_family_name,
    guardian_given_name::text AS guardian_given_name,
    guardian_phone_number::text AS guardian_phone_number,
    title_respondent::text AS title_respondent,
    respondent::text AS respondent,
    respondent_family_name::text AS respondent_family_name,
    respondent_given_name::text AS respondent_given_name,
    respondent_address::text AS respondent_address,
    respondent_phone_number::text AS respondent_phone_number,
    respondent_relationship::text AS respondent_relationship,
    date_of_onset::text AS date_of_onset,
    fever_at_onset_of_paralysis::text AS fever_at_onset_of_paralysis,
    progressive_paralysis::text AS progressive_paralysis,
    paralysis_acute_and_flaccid::text AS paralysis_acute_and_flaccid,
    paralysis_asymmetrical::text AS paralysis_asymmetrical,
    paralysis_site::text AS paralysis_site,
    paralysis_site_other::text AS paralysis_site_other,
    paralyzed_limb_sensitive_to_pain::text AS paralyzed_limb_sensitive_to_pain,
    injection_before_paralysis::text AS injection_before_paralysis,
    injection_site::text AS injection_site,
    provisional_diagnosis::text AS provisional_diagnosis,
    outcome,   ::text AS outcome,    
    record_exposure::text AS record_exposure,
    exposure_type::text AS exposure_type,
    food_name::text AS food_name,
    food_consumption_date::text AS food_consumption_date,
    food_source::text AS food_source,
    food_participants_count::text AS food_participants_count,
    food_affected_participants_count::text AS food_affected_participants_count,
    water_sources::text AS water_sources,
    water_sources_other::text AS water_sources_other,
    toilet_types::text AS toilet_types,
    toilet_types_other::text AS toilet_types_other,
    travel_origin_country::text AS travel_origin_country,
    travel_origin_city::text AS travel_origin_city,
    travel_departure_date::text AS travel_departure_date,
    travel_destination_country::text AS travel_destination_country,
    travel_destination_city::text AS travel_destination_city,
    travel_arrival_date::text AS travel_arrival_date,
    animal_exposure::text AS animal_exposure,
    animal_exposure_other::text AS animal_exposure_other,
    animal_species::text AS animal_species,
    animal_species_other::text AS animal_species_other,
    animal_exposure_location::text AS animal_exposure_location,
    total_vaccine_doses::text AS total_vaccine_doses,
    date_of_opv_doses_at_birth::text AS date_of_opv_doses_at_birth,
    first_dose_date::text AS first_dose_date,
    second_dose_date::text AS second_dose_date,
    third_dose_date::text AS third_dose_date,
    fourth_dose_date::text AS fourth_dose_date,
    last_dose_date::text AS last_dose_date,
    last_opv_sia_dose::text AS last_opv_sia_dose,
    total_opv_sia_doses::text AS total_opv_sia_doses,
    total_opv_ri_doses::text AS total_opv_ri_doses,
    total_ipv_sia_doses::text AS total_ipv_sia_doses,
    total_ipv_ri_doses::text AS total_ipv_ri_doses,
    date_ipv_sia_ri::text AS date_ipv_sia_ri,
    stool_condition::text AS stool_condition,
    date_final_culture_result_available::text AS date_final_culture_result_available,
    date_specimen_received_in_ic_lab::text AS date_specimen_received_in_ic_lab,
    lab_id::text AS lab_id,
    final_cell_culture_result::text AS final_cell_culture_result,
    date_results_sent_to_national_epi::text AS date_results_sent_to_national_epi,
    date_isolate_sent_by_national_laboratory_to_regional_laboratory::text AS date_isolate_sent_by_national_laboratory_to_regional_laboratory,
    date_itd_results_sent_by_regional_laboratory::text AS date_itd_results_sent_by_regional_laboratory,
    date_itd_results_received_by_county::text AS date_itd_results_received_by_county,
    date_isolate_sent_for_sequencing::text AS date_isolate_sent_for_sequencing,
    date_final_results_sent_to_epi::text AS date_final_results_sent_to_epi,
    title_final_results::text AS title_final_results,
    w1_results::text AS w1_results,
    w2_results::text AS w2_results,
    w3_results::text AS w3_results,
    discordant_sabin::text AS discordant_sabin,
    sl1_results::text AS sl1_results,
    sl2_results::text AS sl2_results,
    sl3_results::text AS sl3_results,
    vdpv1_results::text AS vdpv1_results,
    vdpv2_results::text AS vdpv2_results,
    vdpv3_results::text AS vdpv3_results,
    rnev_results::text AS rnev_results,
    rnpent_results::text AS rnpent_results,
    date_first_specimen_collected::text AS date_first_specimen_collected,
    date_second_specimen_collected::text AS date_second_specimen_collected,
    date_specimen_sent_to_national::text AS date_specimen_sent_to_national,
    date_specimen_received_at_national::text AS date_specimen_received_at_national,
    date_specimen_sent_to_lab::text AS date_specimen_sent_to_lab,
    immunocompromised_status_suspected::text AS immunocompromised_status_suspected,
    afp_final_case_classification::text AS afp_final_case_classification,
    afp_vdpv_serotype::text AS afp_vdpv_serotype,
    place::text AS place,
    duration_months::text AS duration_months,
    duration_days::text AS duration_days,
    vaccine_administered::text AS vaccine_administered,
    date_of_vaccination::text AS date_of_vaccination,
    total_vaccine_doses2::text AS total_vaccine_doses2,
    total_vaccine_sia_doses::text AS total_vaccine_sia_doses
FROM {{ ref('stg_acute_flaccid_paralysis') }}
WHERE date_of_onset IS NOT NULL
